# 파트너 확인 페이지 배포 노트

## 구현 완료 항목

### 1. 확인 페이지 (confirm.html)

- ✅ 요청 정보 표시 (예약번호, 예약일시, 문의 유형, 고객 문의 내용)
- ✅ 3가지 응답 옵션 버튼 (수락/거절/대안)
- ✅ 대안 시간 입력 필드 (datetime-local)
- ✅ 반응형 디자인
- ✅ 로딩 상태 표시

### 2. 확인 페이지 로직 (confirm.js)

- ✅ URL에서 토큰 추출 (경로 및 쿼리 파라미터 지원)
- ✅ GET /confirm/{token} API 호출
- ✅ 토큰 검증 및 에러 처리
- ✅ 요청 정보 표시
- ✅ 응답 선택 UI 상태 관리
- ✅ POST /respond API 호출
- ✅ 응답 성공/실패 메시지 표시
- ✅ 토큰 무효/만료 시 에러 페이지로 리다이렉트

### 3. 에러 페이지 (error.html, error.js)

- ✅ 토큰 무효/만료 시 표시
- ✅ 5가지 에러 유형 지원:
  - invalid_token: 유효하지 않은 링크
  - expired_token: 링크 만료
  - already_used: 이미 사용된 링크
  - not_found: 요청을 찾을 수 없음
  - default: 일반 오류
- ✅ 고객센터 연락처 정보 표시
- ✅ 사용자 친화적인 에러 메시지

### 4. 스타일링 (styles.css)

- ✅ 파트너 확인 페이지 스타일
- ✅ 응답 버튼 스타일 (수락/거절/대안)
- ✅ 선택 상태 표시
- ✅ 성공 메시지 애니메이션
- ✅ 에러 페이지 스타일
- ✅ 반응형 디자인 (모바일 지원)

### 5. S3 배포 설정

- ✅ FrontendStack에서 자동 배포 설정 완료
- ✅ 모든 파일이 frontend/ 디렉토리에 위치
- ✅ CDK 배포 시 자동으로 S3에 업로드됨

## 배포 방법

```bash
# CDK 배포
cdk deploy PartnerConfirmation-FrontendStack

# 출력되는 WebsiteUrl 확인
# 예: http://partner-confirmation-customer-123456789012-ap-northeast-2.s3-website.ap-northeast-2.amazonaws.com
```

## 접근 URL

### 고객 문의 페이지

```
{WebsiteUrl}/index.html
```

### 파트너 확인 페이지

```
{WebsiteUrl}/r/{token}
또는
{WebsiteUrl}/confirm.html?token={token}
```

### 에러 페이지

```
{WebsiteUrl}/error.html?reason={error_type}
```

## 테스트 시나리오

### 1. 정상 플로우

1. 파트너가 SMS 링크 클릭
2. confirm.html 페이지 로드
3. 토큰 검증 및 요청 정보 표시
4. 응답 선택 (수락/거절/대안)
5. 응답 제출
6. 성공 메시지 표시

### 2. 대안 시간 제안

1. 파트너가 "대안 제안" 버튼 클릭
2. 대안 시간 입력 필드 표시
3. 날짜/시간 선택
4. 응답 제출
5. 성공 메시지 표시

### 3. 토큰 무효

1. 잘못된 토큰으로 접근
2. error.html로 리다이렉트
3. "유효하지 않은 링크" 메시지 표시

### 4. 토큰 만료

1. 만료된 토큰으로 접근
2. error.html로 리다이렉트
3. "링크가 만료되었습니다" 메시지 표시

### 5. 토큰 재사용

1. 이미 사용된 토큰으로 응답 제출
2. 409 에러 반환
3. "이 링크는 이미 사용되었습니다" 메시지 표시

## 주의사항

1. **토큰 URL 형식**: SMS에서 전송되는 링크는 `{WebsiteUrl}/r/{token}` 형식이어야 함
2. **CORS 설정**: API Gateway에서 CORS가 활성화되어 있어야 함
3. **토큰 만료**: 토큰은 10분 후 자동 만료됨
4. **1회용 링크**: 각 토큰은 한 번만 사용 가능
5. **모바일 최적화**: 파트너가 모바일에서 접근하므로 반응형 디자인 필수

## 요구사항 매핑

- ✅ 요구사항 4.1: 토큰 검증 (서명, 만료)
- ✅ 요구사항 4.2: 토큰 무효/만료 시 에러 페이지 표시
- ✅ 요구사항 4.3: 요청 정보 표시 및 확인 페이지
- ✅ 요구사항 4.4: 3가지 응답 옵션 제공
- ✅ 요구사항 4.5: Opened 이벤트 기록 (response-handler에서 처리)
- ✅ 요구사항 5.1: 응답 제출 및 API 호출
- ✅ 요구사항 8.5: S3 정적 웹사이트 호스팅

## 다음 단계

Task 13: Amazon Lex V2 봇 설정
Task 14: 통합 테스트 및 엔드투엔드 시나리오 검증
Task 15: 배포 및 데모 준비
